---
import fetchData from "../../lib/fetchData.ts";
import type FetchData from "../../interfaces/FetchData.ts";
import type BlogItem from "../../interfaces/BlogItem.ts";
import Layout from "../../layouts/Layout.astro";
import BlogHeader from "../../components/sections/blog/BlogHeader.tsx";
import BlogGrid from "../../components/sections/blog/BlogGrid.tsx";
import BlogPagination from "../../components/sections/blog/BlogPagination.tsx";
import Subscribe from "../../components/sections/blog/Subscribe.tsx";

const { page } = Astro.params;

const queryPost = `
query Query($limit: Int, $skip: Int, $sort: JsonType) {
  blogModel(limit: $limit, skip: $skip, sort: $sort) {
		_id
		_created
		title
		perex
		image
		author {
			name
			title
			photo
		}
	}
}
`;

const variables = {
  limit: 0,
  skip: 0,
	sort: { _created: -1 },
};

const { blogModel: posts }: FetchData = await fetchData(queryPost, variables);
---

<Layout title={`Blog - Stranka ${page} - Human Design`} description="">
	<BlogHeader />
	<BlogGrid posts={posts as BlogItem[]} />
	<BlogPagination />
	<Subscribe />
</Layout>